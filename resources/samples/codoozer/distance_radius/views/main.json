{
    "object": "view",
    "id": "main",
    "title": {
        "default": "Distance radius",
        "es":"Radio de distancia"
    },
    "wrapper": "main",
    "orientation": "vertical",
    "events":{
    	"onloaded":[
    		{
    			"function":"set",
    			"what":"@element.radiusRange.value",
    			"value":"@cookie.radius"
    		}
    	],
    	"onbackpressed":[
    		{
    			"function":"set",
    			"what":"@property.wasVisible",
    			"value":true,
    			"if":{
    				"what":"@element.unitsMenu.visible",
    				"is":true,
    				"else":{
    					"function":"set",
		    			"what":"@property.wasVisible",
		    			"value":false
    				}
    			}
    		},
    		{
    			"function":"set",
    			"what":"@element.unitsMenu.visible",
    			"value":false,
    			"if":{
    				"what":"@element.unitsMenu.visible",
    				"is":true
    			}
    		},{
    			"function":"abort",
    			"if":{
    				"what":"@property.wasVisible",
    				"is":true
    			}
    		},
    		{
    			"function":"back"
    		}
    	]
    },
    "content": [
		{
			"id":"workArea",
			"type":"group",
			"width":"100%",
			"height":"fill",
			"valign":"top",
			"content":[
		    	{
		    		"id":"mainMap",
		    		"type":"map",
		    		"width":"100%",
		    		"height":"fill",
		    		"min_zoom":5,
		    		"max_zoom":20,
		    		"center":"@property.startPosition",
		    		"zoom":"@property.startZoom",
		    		"data_source": "@database.geos",
		    		"enable_location":true,
		    		"events":{
		    			"onready":[
		    				{
		    					"function":"set",
		    					"what":"@property.startZoom",
		    					"value":"@cookie.currentZoom",
		    					"if":{
		    						"what":"@cookie.currentZoom",
		    						"is_not":null
		    					}
		    				},
		    				{
		    					"function":"set",
		    					"what":"@property.startPosition",
		    					"value":"@cookie.currentPosition",
		    					"if":{
		    						"what":"@cookie.currentPosition",
		    						"is_not":null
		    					}
		    				},
		    				{
		    					"function":"set",
		    					"what":"@property.startPosition",
		    					"value":"@app.location",
		    					"if":{
		    						"what":"@cookie.currentPosition",
		    						"is":null
		    					}
		    				},
		    				{
		    					"function":"set",
		    					"what":"@property.startZoom",
		    					"value":17,
		    					"if":{
		    						"what":"@cookie.currentPosition",
		    						"is":null
		    					}
		    				},
		    				
		    				{
		    					"function":"set",
		    					"what":"@database.geos.0.lat",
		    					"value":"@app.location.latitude",
		    					"if":{
		    						"what":"@cookie.circleLat",
		    						"is":null
		    					}
		    				},
		    				{
		    					"function":"set",
		    					"what":"@database.geos.0.lng",
		    					"value":"@app.location.longitude",
		    					"if":{
		    						"what":"@cookie.circleLat",
		    						"is":null
		    					}
		    				},
		    				
		    				{
		    					"function":"set",
		    					"what":"@database.geos.1.lat",
		    					"value":"@app.location.latitude",
		    					"if":{
		    						"what":"@cookie.circleLat",
		    						"is":null
		    					}
		    				},
		    				{
		    					"function":"set",
		    					"what":"@database.geos.1.lng",
		    					"value":"@app.location.longitude",
		    					"if":{
		    						"what":"@cookie.circleLat",
		    						"is":null
		    					}
		    				}
		    			],
		    			"onchanged":[
		    				{
		    					"function":"set",
		    					"what":"@cookie.currentPosition",
		    					"value":"@element.mainMap.position"
		    				},
		    				{
		    					"function":"set",
		    					"what":"@cookie.currentZoom",
		    					"value":"@element.mainMap.zoom"
		    				}
		    			],
		    			"onclick":[
		    				{
		    					"function":"set",
		    					"what":"@database.geos.0.lat",
		    					"value":"@element.mainMap.clickedLat"
		    				},
		    				{
		    					"function":"set",
		    					"what":"@database.geos.0.lng",
		    					"value":"@element.mainMap.clickedLng"
		    				},
		    				
		    				{
		    					"function":"set",
		    					"what":"@database.geos.1.lat",
		    					"value":"@element.mainMap.clickedLat"
		    				},
		    				{
		    					"function":"set",
		    					"what":"@database.geos.1.lng",
		    					"value":"@element.mainMap.clickedLng"
		    				},
		    				{
		    					"function":"set",
		    					"what":"@cookie.circleLat",
		    					"value":"@element.mainMap.clickedLat"
		    				},
		    				{
		    					"function":"set",
		    					"what":"@cookie.circleLng",
		    					"value":"@element.mainMap.clickedLng"
		    				}
		    			]
		    		}
		    	},
		        {
		        	"id":"toolBar",
		        	"type":"group",
		        	"width":"100%",
		        	"height":"wrap",
		        	"valign":"bottom",
		        	"background":{
		        		"type":"solid",
		        		"color":"@color.settingsBarColor"
		        	},
		        	"padding":{
		        		"start":18,
		        		"end":18,
		        		"bottom":12
		        	},
		        	"content":[
		        		{
		        			"id":"groupRadius",
		        			"type":"group",
		        			"orientation":"horizontal",
		        			"width":"100%",
		        			"height":"wrap",
		        			"content":[
		        				{
				        			"id":"radiusTxt",
				        			"type":"text",
				        			"width":"65%",
				        			"height":"wrap",
				        			"font_size":14,
				        			"font":"@font.renner",
				        			"color":"@color.settingsBarTextColor",
				        			"text":{
				        				"default":"Radius:",
				        				"es":"Radio:"
				        			}
				        		},
				        		{
				        			"id":"currentRadius",
		        					"type":"inputtext",
		        					"width":"fill",
		        					"height":"wrap",
		        					"valign":"middle",
		        					"text_align":"end",
		        					"source":"@cookie.radius",
		        					"font_size":18,
				        			"font":"@font.renner",
				        			"color":"@color.settingsBarTextColor",
				        			"border_color":"@color.radiusFieldBorder",
				        			"decimals":1,
				        			"format":"number",
				        			"text_align":"end",
				        			"events":{
										"onchanged":[
											{
												"function":"set",
												"what":"@property.finalRadius",
												"value":"@cookie.radius"
											},
											{
												"function":"multiply",
												"what":"@property.finalRadius",
												"by":"@cookie.factor"
											},
											{
												"function":"set",
												"what":"@database.geos.0.radius",
												"value":"@property.finalRadius"
											}
										]
									}

				        		},
				        		{
				        			"id":"currentUnits",
		        					"type":"text",
		        					"width":48,
		        					"height":"wrap",
		        					"halign":"end",
		        					"text_align":"center",
		        					"valign":"middle",
		        					"source":"@cookie.units",
		        					"font_size":18,
				        			"font":"@font.renner",
				        			"background":{
				        				"type":"solid",
				        				"color":"@color.unitsButtonColor"
				        			},
				        			"padding":8,
				        			"color":"@color.unitsButtonTextColor",
				        			"text_align":"start",
				        			"margin":{
				        				"start":12
				        			},
				        			"events":{
				        				"onclick":[
				        					{
				        						"function":"set",
				        						"what":"@element.unitsMenu.visible",
				        						"value":true
				        					}
				        				]
				        			}
				        		}
		        			]
		        		},
		        		
		        		{
		        			"id":"radiusRange",
							"type":"range",
							"width":"100%",
							"height":"wrap",
							"valign":"middle",
							"start_at":0.1,
							"steps":1000,
							"step_value":0.1,
							"value":1,
							"source":"@cookie.radius",
							"margin":{
								"top":16,
								"bottom":24
							},
							"events":{
								"onchanged":[
									{
										"function":"set",
										"what":"@property.finalRadius",
										"value":"@cookie.radius"
									},
									{
										"function":"multiply",
										"what":"@property.finalRadius",
										"by":"@cookie.factor"
									},
									{
										"function":"set",
										"what":"@database.geos.0.radius",
										"value":"@property.finalRadius"
									}
								]
							}
		        			
		        		}
		        	]
		        },
		        {
		        	"id":"unitsMenu",
		        	"type":"group",
		        	"width":"100%",
		        	"height":"100%",
		        	"position":"absolute",
		        	"visible":false,
		        	"events":{
		        		"onclick":{
		        			"function":"set",
		        			"what":"@element.unitsMenu.visible",
		        			"value":false
		        		}
		        	},
		        	"content":[
		        		{
				        	"id":"unitsFloatMenu",
				        	"type":"group",
				        	"width":"wrap",
				        	"position":"absolute",
				        	"halign":"end",
				        	"valign":"bottom",
				        	"height":"wrap",
				        	"margin":{
				        		"bottom":48,
				        		"end":16
				        	},
				        	"background":{
				        		"type":"solid",
				        		"color":"@color.unitsMenuBackground"
				        	},
				        	"content":[
				        		{
				        			"id":"unitOptKm",
				        			"type":"text",
				        			"width":"100%",
				        			"height":"wrap",
				        			"text":{
				        				"en":"Kilometers",
				        				"es":"Kilómetros"
				        			},
				        			"text_align":"start",
				        			"padding":{
				        				"top":8,
				        				"bottom":8,
				        				"start":24,
				        				"end":24
				        			},
				        			"font_size":18,
						        	"font":"@font.renner",
						        	"color":"@color.unitsMenuColor",
						        	"events":{
						        		"onclick":[
						        			{
							        			"function":"set",
							        			"what":"@cookie.units",
							        			"value":"Km."
							        		},
							        		{
							        			"function":"set",
							        			"what":"@cookie.factor",
							        			"value":1
							        		},{
							        			"function":"set",
							        			"what":"@element.unitsMenu.visible",
							        			"value":false
							        		},
							        		{
								                "function":"set",
								                "what":"@cookie.factor",
								                "value":1000
							            	},
							            	{
												"function":"set",
												"what":"@property.finalRadius",
												"value":"@cookie.radius"
											},
											{
												"function":"multiply",
												"what":"@property.finalRadius",
												"by":"@cookie.factor"
											},
											{
												"function":"set",
												"what":"@database.geos.0.radius",
												"value":"@property.finalRadius"
											}
						        		]
						        	}

				        		},
				        		{
				        			"id":"unitOptM",
				        			"type":"text",
				        			"width":"100%",
				        			"height":"wrap",
				        			"text":{
				        				"en":"Meters",
				        				"es":"Metros"
				        			},
				        			"padding":{
				        				"top":8,
				        				"bottom":8,
				        				"start":24,
				        				"end":24
				        			},
				        			"text_align":"start",
				        			"font_size":18,
						        	"font":"@font.renner",
						        	"color":"@color.unitsMenuColor",
						        	"events":{
						        		"onclick":[
						        			{
							        			"function":"set",
							        			"what":"@cookie.units",
							        			"value":"m."
							        		},
							        		{
							        			"function":"set",
							        			"what":"@cookie.factor",
							        			"value":1
							        		},{
							        			"function":"set",
							        			"what":"@element.unitsMenu.visible",
							        			"value":false
							        		},
							        		{
								                "function":"set",
								                "what":"@cookie.factor",
								                "value":1
							            	},
							            	{
												"function":"set",
												"what":"@property.finalRadius",
												"value":"@cookie.radius"
											},
											{
												"function":"multiply",
												"what":"@property.finalRadius",
												"by":"@cookie.factor"
											},
											{
												"function":"set",
												"what":"@database.geos.0.radius",
												"value":"@property.finalRadius"
											}
						        		]
						        	}

				        		},
				        		{
				        			"id":"unitOptF",
				        			"type":"text",
				        			"width":"100%",
				        			"height":"wrap",
				        			"text":{
				        				"en":"Feet",
				        				"es":"Pies"
				        			},
				        			"padding":{
				        				"top":8,
				        				"bottom":8,
				        				"start":24,
				        				"end":24
				        			},
				        			"text_align":"start",
				        			"font_size":18,
						        	"font":"@font.renner",
						        	"color":"@color.unitsMenuColor",
						        	"events":{
						        		"onclick":[
						        			{
							        			"function":"set",
							        			"what":"@cookie.units",
							        			"value":"ft."
							        		},
							        		{
							        			"function":"set",
							        			"what":"@cookie.factor",
							        			"value":1
							        		},{
							        			"function":"set",
							        			"what":"@element.unitsMenu.visible",
							        			"value":false
							        		},
							        		{
								                "function":"set",
								                "what":"@cookie.factor",
								                "value":0.3048
							            	},
							            	{
												"function":"set",
												"what":"@property.finalRadius",
												"value":"@cookie.radius"
											},
											{
												"function":"multiply",
												"what":"@property.finalRadius",
												"by":"@cookie.factor"
											},
											{
												"function":"set",
												"what":"@database.geos.0.radius",
												"value":"@property.finalRadius"
											}
						        		]
						        	}

				        		},
				        		{
				        			"id":"unitOptMI",
				        			"type":"text",
				        			"width":"100%",
				        			"height":"wrap",
				        			"text":{
				        				"en":"Miles",
				        				"es":"Millas"
				        			},
				        			"padding":{
				        				"top":8,
				        				"bottom":8,
				        				"start":24,
				        				"end":24
				        			},
				        			"text_align":"start",
				        			"font_size":18,
						        	"font":"@font.renner",
						        	"color":"@color.unitsMenuColor",
						        	"events":{
						        		"onclick":[
						        			{
							        			"function":"set",
							        			"what":"@cookie.units",
							        			"value":"mi."
							        		},
							        		{
							        			"function":"set",
							        			"what":"@cookie.factor",
							        			"value":1
							        		},{
							        			"function":"set",
							        			"what":"@element.unitsMenu.visible",
							        			"value":false
							        		},
							        		{
								                "function":"set",
								                "what":"@cookie.factor",
								                "value":1609.34
							            	},
							            	{
												"function":"set",
												"what":"@property.finalRadius",
												"value":"@cookie.radius"
											},
											{
												"function":"multiply",
												"what":"@property.finalRadius",
												"by":"@cookie.factor"
											},
											{
												"function":"set",
												"what":"@database.geos.0.radius",
												"value":"@property.finalRadius"
											}
						        		]
						        	}

				        		},
				        		{
				        			"id":"unitOptMN",
				        			"type":"text",
				        			"width":"100%",
				        			"height":"wrap",
				        			"text":{
				        				"en":"Nautical miles",
				        				"es":"Millas náuticas"
				        			},
				        			"text_align":"start",
				        			"padding":{
				        				"top":8,
				        				"bottom":8,
				        				"start":24,
				        				"end":24
				        			},
				        			"font_size":18,
						        	"font":"@font.renner",
						        	"color":"@color.unitsMenuColor",
						        	"events":{
						        		"onclick":[
						        			{
							        			"function":"set",
							        			"what":"@cookie.units",
							        			"value":"nm."
							        		},
							        		{
							        			"function":"set",
							        			"what":"@cookie.factor",
							        			"value":1
							        		},{
							        			"function":"set",
							        			"what":"@element.unitsMenu.visible",
							        			"value":false
							        		},
							        		{
								                "function":"set",
								                "what":"@cookie.factor",
								                "value":1852
							            	},
							            	{
												"function":"set",
												"what":"@property.finalRadius",
												"value":"@cookie.radius"
											},
											{
												"function":"multiply",
												"what":"@property.finalRadius",
												"by":"@cookie.factor"
											},
											{
												"function":"set",
												"what":"@database.geos.0.radius",
												"value":"@property.finalRadius"
											}
						        		]
						        	}

				        		}
				        	]
				        }
		        	]
		        }
		        
    		]
    	},
        {
            "id":"mainBanner",
            "type":"banner",
            "valign":"bottom",
            "height":"wrap",
            "width":"100%",
            "placement":"banner_main"
        }
    ]
}

